# ce1sus api #

This project contains all the required functionalities to access the ce1sus RESTAPI via Python and also offers 
the program to import events from MISP (https://github.com/MISP/MISP) to ce1sus.

## Requirements ##

* python (2.7+)
* requests (1.3.0+)
* dateutil (1.5+)
* urllib2 

## Installation ##
Install the required libraries and clone the repository.

### Configuration ###
A template of a configuration file can be found in "ce1sus_adapter.conf_sample". 
The configuration file must be found under "~/.ce1sus_adapter.conf". 
It contains all the configurations for the different MISPs and Ce1suses. 

Note: The tag and the text behind the underscore ("_") have to be the same. 
This text is used later on to access the corresponding MISP or Ce1sus. 

## Documentation ##
### API ###
The module using the RESTAPI is located in the ce1sus_api.api.ce1sus.api and each function returns a or a list of RESTXXXX objects. 
These RestXXX classes are located in the ce1sus.api.restclasses module.
 
The API supports
* Returning multiple/single events by their uuid
* Insertion of events/definitions
* Returning multiple/single definitions
* Search for attributes

Note: The search is a bit tricky the following parameters:
*objectType
*objectContainsAttribute

Specify what is requested i.e. objectType='Executable' then the search takes into account only the events with objects of
type 'Executable' the objectContainsAttribute parameter is a dict setup as follows
{ file_name: foo.exe, is_malicious: True }. This last parameter is used to search in the attributes.

Currently there is no possibility to make OR operations on search requests.

The parameter "filterAttributes" specifies a filter for attribute types. This means that the event will only hold
the objects which the requested attribute belongs to, and no other attribute than the requested one. 
Objects without this attribute will not be send.

Please look, for the moment, at the source code for more informations.

## Examples ##
The configuration file contains the following:

[misp_cert]
....
[ce1sus_local]
....

The command to import from the event 689 from the MISP "cert" to the ce1sus "local" is the following:

./misp_to_ce1sus.py -m cert -c ce1sus -e 689 

## Usage ##

Usage: misp_to_ce1sus.py [options]

Options:
  -h, --help     show this help message and exit
  -m MISP        MISP instance to use
  -c CE1SUS      ce1sus instance to use
  -e MISP_EVENT  MISP event ID
  -v             verbose output
  -d             dry-run, do not store anything in ce1sus
  --xml          output raw MISP XML

